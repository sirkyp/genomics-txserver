<h3>Search</h3>

<form method="get" id="searchForm" action="{{ baseUrl }}/CodeSystem">
<table class="grid" cellpadding="0" cellspacing="0">
<tr>
<td colspan="2">URL: <input type="text" name="url" size="40"/></td>
<td>Version: <input type="text" name="version"/></td>
</tr>
<tr>
<td title="Searches in name, title, description, publisher">Text: <input type="text" name="text"/></td>
<td>Status: <select name="status" class="form-select"><option value="">(any status)</option>
<option value="draft">draft</option><option value="active">active</option>
<option value="retired">retired</option><option value="unknown">unknown</option></select></td>
<td>Language: <input type="text" name="lang" size="10"/> (ietf code)</td>
</tr>
<tr>
<td colspan="2" title="CodeSystem - for supplements, value sets, and concept maps">System: <input type="text" name="system" size="40"/></td>
<td>CS Content: <select name="content-mode" class="form-select"><option value="">(any content)</option>
<option value="not-present">not-present</option><option value="example">example</option>
<option value="fragment">fragment</option><option value="complete">complete</option>
<option value="supplement">supplement</option></select></td>
</tr>
</table>

<input type="hidden" name="_elements" id="elementsInput" value="url,version,name,title,status,content,date" disabled/>

<button type="submit" class="btn btn-primary">Search:</button>
<input type="radio" name="mode" value="cs" checked onchange="updateSearchAction('{{ baseUrl }}')"/> CodeSystems
<input type="radio" name="mode" value="vs" onchange="updateSearchAction('{{ baseUrl }}')"/> ValueSets
<input type="radio" name="mode" value="cm" onchange="updateSearchAction('{{ baseUrl }}')"/> ConceptMaps
|
<input type="checkbox" id="summaryTable" onchange="updateSummaryTable()"/> <label for="summaryTable">Summary Table</label>
</form>

<p>Or see the <a href="op.html">Operations</a></p>

<script>
function updateSearchAction(baseUrl) {
  const form = document.getElementById('searchForm');
  const mode = document.querySelector('input[name="mode"]:checked').value;
  const resourceMap = { cs: 'CodeSystem', vs: 'ValueSet', cm: 'ConceptMap' };
  form.action = baseUrl + '/' + resourceMap[mode];
}

function updateSummaryTable() {
  const checkbox = document.getElementById('summaryTable');
  const elementsInput = document.getElementById('elementsInput');
  elementsInput.disabled = !checkbox.checked;
  localStorage.setItem('txSummaryTable', checkbox.checked);
}

// Restore summary table preference on page load
document.addEventListener('DOMContentLoaded', function() {
  const saved = localStorage.getItem('txSummaryTable');
  if (saved === 'true') {
    const checkbox = document.getElementById('summaryTable');
    checkbox.checked = true;
    document.getElementById('elementsInput').disabled = false;
  }
});

</script>